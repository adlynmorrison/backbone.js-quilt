<!doctype html>
<html>
<head>
  <title>Underscore Template Demo</title>
  <link rel="stylesheet" href="http://cdnjs.cloudflare.com/ajax/libs/pure/0.4.2/pure-min.css">
</head>
<body>

<h1>Todos</h1>

<div class="pure-g">
  <div class="pure-u-1-2">
    <form action="" id="todo-form" class="pure-form pure-form-aligned">
      <div class="pure-control-group">
        <label for="title">Title</label>
        <input type="text" id="title" name="title">
      </div>
      <div class="pure-control-group">
        <label for="due">Due</label>
        <input type="date" id="due" name="due">
      </div>
      <div class="pure-control-group">
        <label for="notes">Notes</label>
        <textarea name="notes" id="notes" cols="30" rows="10"></textarea>
      </div>
      <div class="pure-control-group">
      	<label for="important">Important</label>
        <input type="checkbox" id="important"></label>
      </div>
      <div class="pure-controls">
        <button type="submit" id="create-todo" class="pure-button pure-button-primary">Add Task</button>
      </div>
    </form>
  </div>
  <div class="pure-u-1-2">
    <ol id="todo-list"></ol>
  </div>
</div>

<script type="text/template" id="todo-template">
  <li>
    <strong><%= title %></strong>
    <br>
    <small>Due: <%= due %></small>
    <p>
      <%= notes %>
    </p>
	<% if(important === true) { %>
		IMPORTANT!
		<% } %>
  </li>
</script>

<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js"></script>
<script src="http://cdnjs.cloudflare.com/ajax/libs/underscore.js/1.6.0/underscore-min.js"></script>
<script type="text/javascript">
;(function($){

	//reference/pre-compile our template
	//function can return string, variables, and even functions
	//making a new function every time I make a template function
	var todo_template = _.template($('#todo-template').html());
	
	
	//get a reference to the form elements
	var $todo_form = $('#todo-form');
	var $title = $('#title');
	var $due = $('#due');
	var $notes = $('#notes');
	var $important = $('#important');
	
	//variable to hold form values when submit is clicked
	var form_values;
	
	//variable to hold todo markeup generated by the template
	var todo_markup;
	
	//reference to hold all todos
	var todo_list = $('#todo-list');
	
	//add an event listener to the submit button
	$('#create-todo').on('click', function(e){
		e.preventDefault();
		
		//store the form values in on objects
		//object literal
		//we need keys that match our token
		//can be in any order
		form_values = {
			title: $title.val(),
			due: $due.val(),
			notes: $notes.val(),
			important: $important.is(':checked')
		};
		
		//create markup using our templates
		todo_markup = todo_template(form_values);
		
		console.log(todo_markup);
		
		//appended markup to the DOM
		todo_list.append(todo_markup);
		
		todo_form[0].reset();
	});
})(window.jQuery);
</script>

</body>
</html>